<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz VR - Sólidos Geométricos</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <style>
    body { margin:0; padding:0; overflow:hidden; background:#222; }
    #start-button {
      position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      padding:15px 30px; font-size:20px; background:#4CAF50; color:#fff;
      border:none; border-radius:5px; cursor:pointer; z-index:1000;
    }
  </style>
</head>
<body>
  <button id="start-button">Iniciar Quiz</button>

  <a-scene>
    <a-sky color="#6e9cff"></a-sky>

    <a-entity id="cameraRig" position="0 1.6 0">
      <a-camera id="camera" look-controls>
        <!-- Cursor gaze -->
        <a-cursor id="cursor" fuse="true" fuseTimeout="2000" color="#FFF"></a-cursor>

        <!-- Placar no HUD -->
        <a-entity id="scoreLabel"
          text="value: Placar: 0; align: left; color: yellow; width: 2"
          position="-1.2 0.8 -1.5">
        </a-entity>
      </a-camera>
    </a-entity>

    <!-- Container do Quiz -->
    <a-entity id="quiz-container" position="0 2.9 -4" visible="false">
      <!-- Pergunta -->
      <a-image id="pergunta-img" position="0 1.5 0" width="3.5" height="1.2"></a-image>

      <!-- Opções -->
      <a-entity id="opcoes" position="0 -0.5 0"></a-entity>

      <!-- Mensagem de feedback -->
      <a-entity id="feedbackLabel"
        text="value: ; align: center; color: white; width: 3"
        position="0 -2 0">
      </a-entity>
    </a-entity>
  </a-scene>

  <script>
    const quiz = [
      {
        perguntaImg: "figpage/pergunta1.png",
        opcoes: [
          {img:"figpage/q1a.png", resposta:"Quadrado"},
          {img:"figpage/q1b.png", resposta:"Triângulo"},
          {img:"figpage/q1c.png", resposta:"Círculo"},
          {img:"figpage/q1d.png", resposta:"Cubo"}
        ],
        correta: "Cubo"
      },
      {
        perguntaImg: "figpage/pergunta2.png",
        opcoes: [
          {img:"figpage/q2a.png", resposta:"4"},
          {img:"figpage/q2b.png", resposta:"6"},
          {img:"figpage/q2c.png", resposta:"8"},
          {img:"figpage/q2d.png", resposta:"12"}
        ],
        correta: "6"
      },
      {
        perguntaImg: "figpage/pergunta3.png",
        opcoes: [
          {img:"figpage/q3a.png", resposta:"Cone"},
          {img:"figpage/q3b.png", resposta:"Esfera"},
          {img:"figpage/q3c.png", resposta:"Prisma"},
          {img:"figpage/q3d.png", resposta:"Cubo"}
        ],
        correta: "Cone"
      },
      {
        perguntaImg: "figpage/pergunta4.png",
        opcoes: [
          {img:"figpage/q4a.png", resposta:"Esfera"},
          {img:"figpage/q4b.png", resposta:"Cilindro"},
          {img:"figpage/q4c.png", resposta:"Cubo"},
          {img:"figpage/q4d.png", resposta:"Pirâmide"}
        ],
        correta: "Cubo"
      },
      {
        perguntaImg: "figpage/pergunta5.png",
        opcoes: [
          {img:"figpage/q5a.png", resposta:"Cone"},
          {img:"figpage/q5b.png", resposta:"Cubo"},
          {img:"figpage/q5c.png", resposta:"Cilindro"},
          {img:"figpage/q5d.png", resposta:"Pirâmide"}
        ],
        correta: "Cilindro"
      },
      {
        perguntaImg: "figpage/pergunta6.png",
        opcoes: [
          {img:"figpage/q6a.png", resposta:"Esfera"},
          {img:"figpage/q6b.png", resposta:"Cilindro"},
          {img:"figpage/q6c.png", resposta:"Pirâmide"},
          {img:"figpage/q6d.png", resposta:"Cubo"}
        ],
        correta: "Pirâmide"
      }
    ];

    let perguntaAtual = 0;
    let score = 0;
    const perguntaImgEl = document.getElementById("pergunta-img");
    const opcoesEl = document.getElementById("opcoes");
    const startButton = document.getElementById("start-button");
    const quizContainer = document.getElementById("quiz-container");
    const feedbackLabel = document.getElementById("feedbackLabel");
    const scoreLabel = document.getElementById("scoreLabel");
    const camera = document.getElementById("camera");

    startButton.addEventListener("click", () => {
      startButton.style.display="none";
      quizContainer.setAttribute("visible","true");
      carregarPergunta();
    });

    function carregarPergunta(){
      if(perguntaAtual>=quiz.length){ finalizarQuiz(); return; }
      const dados=quiz[perguntaAtual];
      perguntaImgEl.setAttribute("src",dados.perguntaImg);
      feedbackLabel.setAttribute("text","value: ");
      opcoesEl.innerHTML="";

      const positions = [
        "-1 0.5 0", "1 0.5 0",
        "-1 -0.8 0", "1 -0.8 0"
      ];

      dados.opcoes.forEach((opcao,i)=>{
        const img=document.createElement("a-image");
        img.setAttribute("src",opcao.img);
        img.setAttribute("width","1.3");
        img.setAttribute("height","1.3");
        img.setAttribute("position", positions[i]);
        img.setAttribute("class","opcao");
        img.setAttribute("data-resposta",opcao.resposta);
        img.addEventListener("click",()=>verificarResposta(opcao.resposta,dados.correta));
        opcoesEl.appendChild(img);
      });
    }

    function verificarResposta(selecionada,correta){
      if(selecionada===correta){
        score++;
        scoreLabel.setAttribute("text",`value: Placar: ${score}`);
        feedbackLabel.setAttribute("text","value: ✔ Correto!; color: lime");
        perguntaAtual++;
        resetarVisao();
        setTimeout(carregarPergunta,1500);
      }else{
        feedbackLabel.setAttribute("text","value: ✘ Incorreto!; color: red");
        resetarVisao();
      }
    }

    function finalizarQuiz(){
      perguntaImgEl.setAttribute("src","figpage/final.png");
      opcoesEl.innerHTML="";
      feedbackLabel.setAttribute("text",`value: Quiz finalizado! Placar: ${score}/${quiz.length}; color: yellow`);

      // Botão reinício
      const btn=document.createElement("a-box");
      btn.setAttribute("color","#4CAF50");
      btn.setAttribute("depth","0.2");
      btn.setAttribute("height","0.6");
      btn.setAttribute("width","2");
      btn.setAttribute("position","0 -3 0");
      btn.setAttribute("class","reiniciar");

      const txt=document.createElement("a-entity");
      txt.setAttribute("text","value: Reiniciar; align: center; color: white; width: 3");
      txt.setAttribute("position","0 0 0.2");
      btn.appendChild(txt);

      btn.addEventListener("click", reiniciarQuiz);
      opcoesEl.appendChild(btn);
    }

    function reiniciarQuiz(){
      perguntaAtual=0;
      score=0;
      scoreLabel.setAttribute("text","value: Placar: 0");
      carregarPergunta();
    }

    function resetarVisao(){
      // Reposiciona visão ao centro
      camera.components["look-controls"].pitchObject.rotation.x=0;
      camera.components["look-controls"].yawObject.rotation.y=0;
    }
  </script>
</body>
</html>
